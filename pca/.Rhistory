y[1] <- 2
plot(y)
for(i in 2:100) {e1 <- rnorm(1); y[i] <- -0.05*er[i-1]+ 0.81*y[i-1]+e1; er[i] <- e1}
plot(y)
lines(y)
plot(y,type = "l")
install.packages("manipulate")
install.packages("manipulate")
install.packages("Manipulate")
quit()
ts1
sin(1:100)
plot(sin(1:100))
par(mfcol=c(1,2))
y <- sin(1:100)
acf(y)
pacf(y)
par(mfcol=c(1,1))
pacf(y)
b <- read.table("clipboard",header=TRUE,sep="\t")
b2 <- b
b2$d <- as.Date(b$d,format="%m/%d/%Y")
require(forecast)
ts1 <- ts(b2[,2],start=c(2011,1),frequency=12)
plot(ts1)
acf(ts1)
pacf(ts1)
nd <- ndiffs(ts1)
ns
nd
acf(1:100)
pacf(1:100)
ndiffs(1:100)
pacf(diff(1:100))
acf(diff(1:100))
acf(diff(1:100+3))
x1 <- (1:100)*2
x1 <- (1:100)*2 + 4
plot(x1)
acf(x1)
pacf(x1)
acf(diff(x1))
x1 <- (1:100)^2*2 + 4
plot(x1)
acf(diff(x1))
pacf(diff(x1))
acf(diff(ts1))
pacf(diff(ts1))
acf(diff(ts1))
x1 <- (1:20) + rnorm(21,0,3)
x1 <- (1:20) + rnorm(20,0,3)
plot(x1)
lines(x1)
x1 <- (1:40) + rnorm(40,0,3)
ts2 <- ts(x1,frequency=12)
plot(ts2)
plot(decompose(ts2))
nsdiffs(ts2)
ndiffs(ts2)
acf(ts2)
pacf(ts2)
acf(ts2)
auto.arima(ts2)
y <- {}
y[1] <- 20
er_t <- rnorm(1)
c_constant <- 5
# not sure about that code
gama1 <- -0.9
for(i in 2:100) {
er_t_1 <- y[i-1] - er_t
er_t <- rnorm(1)
y[i] <- gama1*er_t_1+  er_t + 5
}
plot(y)
lines(y)
lines(c(0,100),c(mean(y),mean(y)))
acf(y)
pacf(y)
auto.arima(y)
arima(y,order=c(0,0,1))
arima(y,order=c(0,0,1),include.mean = F)
pacf(y)
acf(y)
acf(diff(y))
pacf(diff(y))
acf(diff(y))
pacf(diff(y))
acf(diff(y))
plot(ts1)
acf(diff(ts1))
pacf(diff(ts1))
acf(diff(ts1))
acf(diff(ts1),lag.max = 14)
auto.arima(ts1)
pacf(diff(ts1))
acf(ts1)
pacf(ts1)
exp(-582.97)
?auto.arima
auto.arima(ts1,ic=c("aicc"),stepwise=FALSE)
auto.arima(ts1,ic=c("aicc"),stepwise=FALSE,trace=T)
tmp <- auto.arima(ts1,ic=c("aicc"),stepwise=FALSE,trace=T)
tmp$aicc
tmp$fitted
plot(ts1)
lines(tmp$fitted)
plot(forecast(tmp,12))
lines(tmp$fitted,col="re")
lines(tmp$fitted,col="red")
?auto.arima
?auto.arima
auto.arima(ts1)
?Arima
Arima(ts1,order(1,1,1),seasonal = c(1,0,0))
Arima(ts1,order=c(1,1,1),seasonal = c(1,0,0))
y <- {}
y[1] <- 20
er_t <- rnorm(1)
c_constant <- 5
# not sure about that code
gama1 <- -0.9
for(i in 2:100) {
er_t_1 <- y[i-1] - er_t
er_t <- rnorm(1)
y[i] <- gama1*er_t_1+  er_t + 5
}
plot(y)
lines(y)
lines(c(0,100),c(mean(y),mean(y)))
Arima(y,order=c(0,0,1),seasonal = c(0,0,0))
Arima(y,order=c(0,0,1),seasonal = c(0,0,0),include.mean = FALSE)
Arima(y,order=c(0,0,1),seasonal = c(0,0,0))
y <- {}
y[1] <- 20
er_t <- rnorm(1)
c_constant <- 5
# not sure about that code
gama1 <- -0.2
for(i in 2:100) {
er_t_1 <- y[i-1] - er_t
er_t <- rnorm(1)
y[i] <- gama1*er_t_1+  er_t + 5
}
plot(y)
lines(y)
lines(c(0,100),c(mean(y),mean(y)))
Arima(y,order=c(0,0,1),seasonal = c(0,0,0))
a1 <- Arima(y,order=c(0,0,1),seasonal = c(0,0,0))
a1$coef
a1$var.coef
a1$x
eeadj <- seasadj(stl(elecequip, s.window="periodic"))
plot(eeadj)
eeadj <- seasadj(stl(ts1, s.window="periodic"))
plot(ts1)
plot(eeadj)
plot(eeadj)
?seasadj
eeadj <- seasadj(stl(ts1, s.window="additive"))
plot(eeadj)
eeadj <- seasadj(stl(ts1))
plot(eeadj)
?stl
eeadj <- seasadj(stl(ts1, s.window="periodic"))
plot(eeadj)
lines(ts1,col="red")
ndiffs(eeadj)
diff(ts1)
plot(diff(ts1))
plot(diff(ts1,differences = 2))
tsdisplay(diff(eeadj),main="")
ts2 <-  seasadj(stl(ts1, s.window="periodic"))
plot(ts2)
tsdisplay(ts2,main="")
Acf(residuals(a1))
Box.test(residuals(fit), lag=24, fitdf=4, type="Ljung")
Box.test(residuals(a1), lag=24, fitdf=4, type="Ljung")
?Box.test
?Box.test
Box.test(residuals(a1),  type="Ljung")
Box.test(residuals(a1),  type="Ljung",fitdf=4)
Box.test(residuals(a1),  type="Ljung",fitdf=4,lag=12)
Box.test(residuals(a1),  type="Ljung",fitdf=4,lag=24)
Box.test(residuals(a1), lag=24, fitdf=4, type="Ljung")
24/4
a1$coef
a1$model
Box.test(residuals(a1),  type="Ljung",fitdf=4,lag=24)
Box.test(residuals(a1),  type="Ljung",fitdf=4,lag=1)
Box.test(residuals(a1),  type="Ljung",fitdf=4,lag=2)
Box.test(residuals(a1),  type="Ljung",fitdf=4,lag=4)
Box.test(residuals(a1),  type="Ljung",fitdf=4,lag=12)
Box.test(residuals(a1),  type="Ljung",fitdf=4,lag=5)
Box.test(residuals(a1),  type="Ljung",fitdf=4,lag=4)
Box.test(residuals(a1),  type="Ljung",fitdf=20,lag=24)
Box.test(residuals(a1),  type="Ljung",fitdf=4,lag=24)
quit()
require(FactoMiner)
install.packages(FactoMiner)
install.packages(factoMiner)
require(FactoMineR)
quit()
require(FactoMineR)
?CA
data(health)
res.cagalt.cat<-CaGalt(health[,1:126],health[,127:129],type="n",conf.ellip=TRUE)
data(children)
data(iris)
require(rpart)
rp1 <- rpart(Species~.,data=iris)
plot(rp1)
quit()
require(Rcmdr)
data(children)
require(FactoMineR)
data(children)
?MFA
?MFA
iris
str(iris)
res_mfa <- MFA(iris,group=c(2,2,1),type=c("s","s","n"),name.group=c("Sepal","Petal","Species"),num.group.sup = 3)
res_mfa <- MFA(iris,group=c(2,2,1),type=c("s","s","n"),name.group=c("Sepal","Petal","Species"))
res_mfa <- MFA(iris,group=c(2,2,1),type=c("s","s","n"),name.group=c("Sepal","Petal","Species"),graph=T)
res_mfa <- MFA(iris,group=c(2,2,1),type=c("s","s","n"),name.group=c("Sepal","Petal","Species"),graph=T)
res_mfa <- MFA(iris,group=c(2,2,1),type=c("s","s","n"),name.group=c("Sepal","Petal","Species"),num.group.sup = 3)
plot(res_mfa,choix=c("var"))
plot(res_mfa,choix=c("ind"))
plot(res_mfa,choix=c("ind"),habillage = iris[,5])
plot(res_mfa,choix=c("ind"),habillage = 3)
plot(res_mfa,choix=c("ind"),habillage = 5)
res_mfa <- MFA(iris,group=c(2,2,1),type=c("s","s","n"),name.group=c("Sepal","Petal","Species"),graph=T)
plot(res_mfa,choix=c("ind"),habillage = 5)
res_mfa <- MFA(iris,group=c(2,2,1),type=c("s","s","n"),name.group=c("Sepal","Petal","Species"),num.group.sup = 3)
plot(res_mfa,choix=c("var"))
plot(res_mfa,choix=c("ind"),habillage = 5)
?plot.MFA
plot(res_mfa,choix=c("group"))
plot(res_mfa,choix=c("ind"))
plot(res_mfa,choix=c("var"))
plot(res_mfa,choix=c("var","group"))
?plot.MFA
plot(res_mfa,choix=c("ind"),habillage = 5,ellipse=T)
plot(res_mfa,choix=c("ind"),habillage = 5,ellipse = TRUE)
res_mfa
res_mfa$eig
dimdesc(res_mfa)
print(res_mfa)
res_mfa$separate.analyses
r2 <- res_mfa$svd$U %*% t(res_mfa$svd$V)
r2 <- res_mfa$svd$U %*% t(res_mfa$svd$V)
r2 <- res$svd$U %*% t(res$svd$V)
r2 <- res_mfa$separate.analyses$Sepal$svd$U %*% t(res_mfa$separate.analyses$Sepal$svd$V)
head(r2)
str(iris)
plot(iris[,1],r2[,1])
l1 <- dim(res_mfa$separate.analyses$Sepal$svd$U)[2]
l1
b_ret <- res_mfa$separate.analyses$Sepal$svd$U %*% diag(res_mfa$separate.analyses$Sepal$svd$vs[1:l1]) %*% t(res_mfa$separate.analyses$Sepal$svd$V)
b_ret
plot(iris[,1],b_ret[,1])
res <- PCA(iris,quali.sup = 5)
r2 <- res$svd$U %*% t(res$svd$V)
head(r2)
plot(iris[,1],r2[,1])
r2 <- res$svd$U %*% diag(res$svd$vs) %*% t(res$svd$V)
plot(iris[,1],r2[,1])
head(r2)
res$svd$vs
r2 <- res$svd$U %*% diag(res$svd$vs[1:2]) %*% t(res$svd$V)
res$svd$vs[1:2]
r2 <- res$svd$U[1:2] %*% diag(res$svd$vs[1:2]) %*% t(res$svd$V[1:2])
r2 <- res$svd$U %*% diag(res$svd$vs[1:2]) %*% t(res$svd$V[1:2])
dim(res$svd$U)
r2 <- res$svd$U[1:2] %*% diag(res$svd$vs[1:2]) %*% t(res$svd$V)
res$svd$U[1:2] %*% diag(res$svd$vs[1:2])
r2 <- res$svd$U[1:2] %*% diag(res$svd$vs[1:2]) %*% t(res$svd$V[1:2])
dim(res$svd$V)
r2 <- res$svd$U[,c(1,2)] %*% diag(res$svd$vs[1:2]) %*% t(res$svd$V)
res$svd$V
r2 <- res$svd$U[,c(1,2)] %*% diag(res$svd$vs) %*% t(res$svd$V)
res$svd$U[,c(1,2)]
res$svd$U[,c(1,2)] %*% diag(res$svd$vs[1:2])
dim(res$svd$U[,c(1,2)])
dim(diag(res$svd$vs[1:2]))
diag(res$svd$vs[1:2])
t(res$svd$V)
diag(res$svd$vs[1:2]) %*% t(res$svd$V[1:2,])
r2 <- res$svd$U[,c(1,2)] %*% diag(res$svd$vs) %*% t(res$svd$V[1:2,])
dim(t(res$svd$V[1:2,]))
diag(res$svd$vs) %*% t(res$svd$V[1:2,])
r2 <- res$svd$U[,c(1,2)] %*% diag(res$svd$vs) %*% t(res$svd$V[1:2,])
diag(res$svd$vs) %*% t(res$svd$V[1:2,])
dim(diag(res$svd$vs) %*% t(res$svd$V[1:2,]))
diag(res$svd$vs) %*% t(res$svd$V[,c(1:2)])
v1 <- diag(res$svd$vs) %*% t(res$svd$V)
dim(v1)
r2 <- res$svd$U[,c(1,2)] %*% v1[,1:2]
r2 <- res$svd$U[,c(1,2)] %*% v1[1:2,]
head(r2)
plot(iris[,1],r2[,1])
plot(iris[,2],r2[,2])
plot(iris[,3],r2[,3])
plot(iris[,4],r2[,4])
?MFA
res_not_scalled <- MFA(iris,group=c(2,2,1),type=c("c","c","n"),name.group=c("Sepal","Petal","Species"),num.group.sup = 3)
r2 <- res_not_scalled$separate.analyses$Sepal$svd$U %*%
diag(res_not_scalled$separate.analyses$Sepal$svd$vs) %*%
t(res_not_scalled$separate.analyses$Sepal$svd$V)
plot(r2[,1],iris[,1])
v1 <- diag(res_not_scalled$separate.analyses$Sepal$svd$vs) %*% t(res_not_scalled$separate.analyses$Sepal$svd$V)
r2 <- res_not_scalled$separate.analyses$Sepal$svd$U[,c(1,2)] %*% v1[1:2,]
plot(iris[,1],r2[,1])
plot(iris[,2],r2[,2])
plot(iris[,3],r2[,2])
head(r2)
res_not_scalled <- MFA(iris,group=c(2,2,1),type=c("c","c","n"),name.group=c("Sepal","Petal","Species"),num.group.sup = 3)
r2 <- res_not_scalled$separate.analyses$Sepal$svd$U %*%
diag(res_not_scalled$separate.analyses$Sepal$svd$vs) %*%
t(res_not_scalled$separate.analyses$Sepal$svd$V)
head(r2)
res_not_scalled$separate.analyses$Sepal$svd$vs
res_not_scalled$separate.analyses$Sepal$svd$U
v1
plot(iris[,2],r2[,2])
sv1 <- svd(iris[,-5])
?svd
plot(sv1$d^2/sum(sv1$d^2),col="blue",pch=19)
lines(sv1$d^2/sum(sv1$d^2),col="black")
plot(sv1$d^2/sum(sv1$d^2),col="blue",pch=19)
lines(sv1$d^2/sum(sv1$d^2),col="black")
barplot(sv1$d^2/sum(sv1$d^2),col="black")
barplot(sv1$d^2/sum(sv1$d^2),col="blue",names.arg = paste(rep("PC",4),1:4,sep = ""))
r1 <- sv1$u[,1:2] %*% diag(sv1$d[1:2]) %*% t(sv1$v[,1:2])
head(r1)
plot(iris[,1],r1[,1])
dim(sv1$u)
dim(sv1$v)
plot(1:150,sv1$u[,1])
plot(1:150,sv1$u[,2])
plot(1:150,sv1$u[,1])
plot(1:150,sv1$u[,1],pch=19)
plot(1:150,sv1$u[,1],pch=19,col=iris[,5])
plot(1:150,sv1$u[,2],pch=19,col=iris[,5])
plot(1:150,sv1$u[,3],pch=19,col=iris[,5])
plot(1:150,sv1$u[,4],pch=19,col=iris[,5])
plot(1:4,sv1$v,pch=19,col=iris[,5])
plot(1:4,sv1$v,pch=19,col=iris[,5])
sv1$v
plot(1:4,sv1$v[,1],pch=19,col=iris[,5])
plot(1:4,sv1$v[1,],pch=19,col=iris[,5])
plot(1:4,sv1$v[1,],pch=19,col=levels(iris[,5]))
plot(1:4,sv1$v[1,],pch=19,col=colnames(iris[,-5]))
bar.plot(1:4,sv1$v[1,],pch=19,names.arg=colnames(iris[,-5]))
barplot(1:4,sv1$v[1,],pch=19,names.arg=colnames(iris[,-5]))
barplot(sv1$v[1,],pch=19,names.arg=colnames(iris[,-5]))
barplot(sv1$v[,1],pch=19,names.arg=colnames(iris[,-5]))
barplot(sv1$v[,2],pch=19,names.arg=colnames(iris[,-5]))
barplot(sv1$v[,3],pch=19,names.arg=colnames(iris[,-5]))
barplot(sv1$v[,4],pch=19,names.arg=colnames(iris[,-5]))
quit()
library(readbitmap)
install.packages("readbitmap")
install.packages("readbitmap")
install.packages("png")
install.packages("jpeg")
img1 <- read.bitmap(f="./pattern1_bw.jpg",channel=1,IdentifyByExtension=T)
img1_2 <- read.bitmap(f="./pattern1_bw.jpg",channel=2,IdentifyByExtension=T)
img1_3 <- read.bitmap(f="./pattern1_bw.jpg",channel=3,IdentifyByExtension=T)
d1 <- dim(img1)
img1 <- read.bitmap(f="./pattern1_bw.jpg",channel=1,IdentifyByExtension=T)
img1_2 <- read.bitmap(f="./pattern1_bw.jpg",channel=2,IdentifyByExtension=T)
img1_3 <- read.bitmap(f="./pattern1_bw.jpg",channel=3,IdentifyByExtension=T)
rm(list=ls())
setwd("E:/R Code/meetup/pca")
library(readbitmap)
library(png)
library(jpeg)
data(iris)
str(iris)
img1 <- read.bitmap(f="./pattern1_bw.jpg",channel=1,IdentifyByExtension=T)
img1_2 <- read.bitmap(f="./pattern1_bw.jpg",channel=2,IdentifyByExtension=T)
img1_3 <- read.bitmap(f="./pattern1_bw.jpg",channel=3,IdentifyByExtension=T)
d1 <- dim(img1)
img2 <- sapply(img1,round)
img3 <- matrix(img2,nrow=d1[1],ncol=d1[2])
d1
dim(img2)
img2 <- sapply(img1,round)
dim(img2)
img2 <- sapply(img1,round)
dim(img2)
img3 <- matrix(img2,nrow=d1[1],ncol=d1[2])
image(img3)
img1 <- read.bitmap(f="./timo.jpg",channel=1,IdentifyByExtension=T
)
d1 <- dim(img1)
img2 <- sapply(img1,round)
img3 <- matrix(img2,nrow=d1[1],ncol=d1[2])
image(img3)
img1 <- read.bitmap(f="./logo.jpg",channel=1,IdentifyByExtension=T)
d1 <- dim(img1)
#d1
img2 <- sapply(img1,round)
img3 <- matrix(img2,nrow=d1[1],ncol=d1[2])
image(img3)
image(t(img3))
ddim <- d1[1]*d1[2]
d_rec <- as.integer(d1[2]/10)
d_rec
sv2 <- svd(img3)
plot(sv2$d^2/sum(sv2$d^2),col="blue",pch=19)
lines(sv2$d^2/sum(sv2$d^2),col="black")
barplot(sv2$d^2/sum(sv2$d^2),col="blue",names.arg = paste(rep("PC",4),1:4,sep = ""))
r3 <- sv2$u[,1:2] %*% diag(sv2$d[1:2]) %*% t(sv2$v[,1:2])
image(r3)
r3 <- sv2$u[,1:6] %*% diag(sv2$d[1:6]) %*% t(sv2$v[,1:6])
image(r3)
i <- sv2$d[1:15]
barplot(i/sum(i),col="blue",names.arg = paste(rep("PC",4),1:4,sep = ""))
i <- sv2$d[1:15]
barplot(i/sum(i),col="blue",names.arg = paste(rep("PC",15),1:15,sep = ""))
image(t(img3))
ddim <- d1[1]*d1[2]
d1[2]
rm(list=ls())
setwd("E:/R Code/meetup/pca")
library(readbitmap)
library(png)
library(jpeg)
data(iris)
head(iris)
?svd
pairs(iris[,-5],col=iris[,5],cex=0.8,cex.labels = 0.86)
sv1 <- svd(iris[,-5])
sv1$u
head(sv1$u)
sv1$d
sv1$d^2
plot(sv1$d^2/sum(sv1$d^2),col="blue",pch=19)
lines(sv1$d^2/sum(sv1$d^2),col="black")
sv1$d^2/sum(sv1$d^2)
barplot(sv1$d^2/sum(sv1$d^2),col="blue",names.arg = paste(rep("PC",4),1:4,sep = ""))
dim(sv1$u)
dim(sv1$v)
sv1$v
r1 <- sv1$u[,1:2] %*% diag(sv1$d[1:2]) %*% t(sv1$v[,1:2])
plot(iris[,1],r1[,1]
)
plot(iris[,2],r1[,2])
plot(iris[,3],r1[,3])
plot(iris[,4],r1[,4])
img1 <- read.bitmap(f="./logo.jpg",channel=1,IdentifyByExtension=T)
d1 <- dim(img1)
img2 <- sapply(img1,round)
img3 <- matrix(img2,nrow=d1[1],ncol=d1[2])
image(t(img3))
d1[2]
dim(img3)
d_rec <- as.integer(d1[2]/10)
sv2 <- svd(img3)
plot(sv2$d^2/sum(sv2$d^2),col="blue",pch=19)
lines(sv2$d^2/sum(sv2$d^2),col="black")
i <- sv2$d[1:15]
barplot(i/sum(i),col="blue",names.arg = paste(rep("PC",15),1:15,sep = ""))
sv2 <- svd(img3)
r3 <- sv2$u[,1:32] %*% diag(sv2$d[1:32]) %*% t(sv2$v[,1:32])
image(r3)
?prcomp
pca1 <- prcomp(iris[,-5],center=T,scale=T)
print(pca1)
pca1$x
head(pca1$x)
plot(pca1$x[,c(1,2)],col=iris[,5],pch=19)
barplot(pca1$sdev^2,names.arg = paste(rep("PC",4),1:4,sep = ""))
plot(pca1$x[,c(1,2)],col=iris[,5],pch=19)
pca1$sdev
barplot(pca1$sdev^2,names.arg = paste(rep("PC",4),1:4,sep = ""))
plot(pca1$x[,c(1,2)],col=iris[,5],pch=19)
pca1$sdev^2
cumsum(pca1$sdev^2)/sum(pca1$sdev^2)
pca2 <- prcomp(iris[,-5],center = FALSE,scale=FALSE)
cumsum(pca2$sdev^2)/sum(pca2$sdev^2)
# return back data
rr <- pca2$x[,1:2] %*% t(pca2$rotation[,1:2])
plot(rr[,1],iris[,1])
plot(rr[,2],iris[,2])
pca2 <- prcomp(iris[,-5],center = T,scale=T)
rr <- pca2$x[,1:2] %*% t(pca2$rotation[,1:2])
plot(rr[,1],iris[,1])
require(FactoMineR)
res <- PCA(iris,quali.sup=5,graph=T)
plot(res,habillage = 5)
dimdesc(res)
print(res)
res$var$cor
res$var$contrib
res$var$cos2
plot(res,choix=c("var"))
plot(res,choix=c("ind"))
plot(res, choix = "var", axes = c(2, 3), lim.cos2.var = 0.5)
plot(res, choix = "var", axes = c(2, 3))
r2 <- res$svd$U %*% diag(res$svd$vs) %*% t(res$svd$V)
v1 <- diag(res$svd$vs) %*% t(res$svd$V)
r2 <- res$svd$U[,c(1,2)] %*% v1[1:2,]
plot(iris[,1],r2[,1])
plot(iris[,2],r2[,2])
plot(iris[,3],r2[,3])
plot(iris[,4],r2[,4])
require(Rcmdr)
res_mfa <- MFA(iris,group=c(2,2,1),type=c("s","s","n"),name.group=c("Sepal","Petal","Species"),graph=T)
quit()
